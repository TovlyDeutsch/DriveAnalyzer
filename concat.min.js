function checkAuth(){gapi.auth.authorize({client_id:CLIENT_ID,scope:SCOPES.join(" "),immediate:!0},handleAuthResult)}function handleAuthResult(e){var t=document.getElementById("authorize-div");e&&!e.error?(t.style.display="none",$(".none").removeClass("none"),loadDriveApi()):(t.style.display="block",$(".mdl-layout__tab-bar-container").addClass("none"))}function handleAuthClick(e){return gapi.auth.authorize({client_id:CLIENT_ID,scope:SCOPES,immediate:!1},handleAuthResult),!1}function loadDriveApi(){gapi.client.load("drive","v3",getFiles)}var CLIENT_ID="363872304328-t3h8sa4icpbaj9lkrpraf5ujoidtsc6h.apps.googleusercontent.com",SCOPES=["https://www.googleapis.com/auth/drive"];
function getFiles(e){parameters={pageSize:1e3,fields:"nextPageToken, files(    id, name, createdTime, fileExtension, quotaBytesUsed, owners, ownedByMe, webViewLink, mimeType)",q:"mimeType != 'application/vnd.google-apps.folder' and trashed = false",orderBy:"createdTime"},e&&(parameters.pageToken=e);var s=gapi.client.drive.files.list(parameters);s.then(function(e){if(files=files.concat(e.result.files),e.result.nextPageToken)getFiles(e.result.nextPageToken);else{sessionStorage.setItem("files",files),$(".first-loader").remove(),fileLists=fileCount(files),displayGraph(files);var s=listFiles(fileLists[0]);sessionStorage.clear(),sessionStorage.setItem("files",JSON.stringify(files)),document.getElementById("table-slot").innerHTML=s,bindEventHandlers()}},function(e){$(".first-loader").remove(),document.getElementById("file-counts").innerHTML=JSON.parse(e.body).error.message})}var files=[];
function listFiles(e,t){for(var o="",n=0;n<e.length;n++)e[n].ownedByMe!==!0&&t!==!0||(o+="      <tr data-link="+e[n].webViewLink+" data-id="+e[n].id+'>      <td class="mdl-data-table__cell--non-numeric">'+e[n].name+'</td>      <td class="narrow">'+e[n].quotaBytesUsed+'</td>      <td class="narrow">'+new Date(Date.parse(e[n].createdTime)).toDateString()+"</td>      </tr>");return o}function bindEventHandlers(){$("#file-list tbody").on("click","tr",function(){if($(this).hasClass("group-header-row")){$(this).nextUntil(".group-header-row").toggleClass("hidden");var e=$(this).children(":first"),t=e.html().split(" ");"▼"===t.pop()?t.push("▶"):t.push("▼"),e.html(t.join(" "))}else $(this).toggleClass("selected"),$(".selected").length>0?$("#delete-button").prop("disabled",!1):$("#delete-button").prop("disabled",!0)}),$("#file-list tbody").on("dblclick","tr",function(){window.open($(this).attr("data-link"),"_blank")}),$("#delete-button").on("click",function(){trashFiles()}),$("input[type=radio][name=options]").change(function(){$("button").prop("disabled",!0),$("input").prop("disabled",!0),$("#delete-loader").css("display","inline-block");var e=JSON.parse(sessionStorage.getItem("files"));if(document.getElementById("option-1").checked)return document.getElementById("table-slot").innerHTML=listFiles(getFilesNotOwned(e)[0]),$("input").prop("disabled",!1),$("label").removeClass("is-disabled"),void $("#delete-loader").css("display","none");if(document.getElementById("option-2").checked)var t=seperateBy(e,"type"),o=!1;else if(document.getElementById("option-3").checked)var t=seperateBy(e,"owner"),o=!0;var n="";for(var a in t){var s="";o===!0&&(s='<img src="'+t[a].ownerPhoto+'"/> '),n+='      <tr class="group-header-row mdl-shadow--2dp">        <td class="group-header mdl-data-table__cell--non-numeric">'+s+a+' ▼</td>        <td class="group-header mdl-data-table__cell--non-numeric">        </td>        <td class="group-header mdl-data-table__cell--non-numeric">        </td>      </tr>',n+=listFiles(t[a].files,o)}document.getElementById("table-slot").innerHTML=n,$("input").prop("disabled",!1),$("label").removeClass("is-disabled"),$("#delete-loader").css("display","none")}),$("input").prop("disabled",!1),$("label").removeClass("is-disabled")}function seperateBy(e,t){var o=e.reduce(function(e,o){var n="type"===t?getType(o):o.owners[0].emailAddress;if(o.ownedByMe===!0||"owner"===t){var a="undefined"==typeof o.owners[0].photoLink?"":o.owners[0].photoLink;e[n]||(e[n]={files:[],ownerPhoto:a}),e[n].files.push(o)}return e},{});return o}function getType(e){if("undefined"!=typeof e.fileExtension&&""!==e.fileExtension)return e.fileExtension.toUpperCase();switch(e.mimeType){case"application/vnd.google-apps.audio":return"Audio";case"application/vnd.google-apps.document":return"Google Docs";case"application/vnd.google-apps.drawing":return"Google Drawing";case"application/vnd.google-apps.file":return"Google Drive file";case"application/vnd.google-apps.folder":return"Google Drive folder";case"application/vnd.google-apps.form":return"Google Forms";case"application/vnd.google-apps.fusiontable":return"Google Fusion Tables";case"application/vnd.google-apps.map":return"Google My Maps";case"application/vnd.google-apps.photo":return"Photos";case"application/vnd.google-apps.presentation":return"Google Slides";case"application/vnd.google-apps.script":return"Google Apps Scripts";case"application/vnd.google-apps.sites":return"Google Sites";case"application/vnd.google-apps.spreadsheet":return"Google Sheets";case"application/vnd.google-apps.unknown":return"Unknown";case"application/vnd.google-apps.video":return"Videos";case"application/pdf":return"PDF"}}function switchData(){}var trashFiles=function e(t){if($("#delete-loader").css("display","inline-block"),void 0===t){var o=!0,n=$(".selected"),a=n.map(function(e,t){return $(t).prop("outerHTML")}).get().join();sessionStorage.setItem("selected",a)}else var o=!1,n=t;for(var s=gapi.client.newBatch(),l=0;l<n.length;l++)s.add(gapi.client.drive.files.update({fileId:n[l].getAttribute("data-id"),trashed:o}));var i=document.getElementById("snackbar"),r={message:"Error: ",timeout:4e3,actionHandler:e,actionText:""},d=!1;s.then(function(e){var t=e.result;for(var n in t)200!==t[n].status&&(r.message+=t[n].result.error.message+", ",d=!0,delete r.actionHandler,delete r.actionText);d===!1&&(r.message=o===!0?"Success":"Done",r.actionText=o===!0?"Undo":"",r.actionHandler=o===!0?Undo:""),i.MaterialSnackbar.showSnackbar(r),o===!0&&d===!1?$(".selected").addClass("trash"):$(".trash").removeClass("trash"),$(".selected").removeClass("selected"),$("#delete-loader").css("display","none")},function(e){r.message+=results[prop].result.error.message+", ",d=!0,console.log(JSON.parse(e.body).error.message)})},Undo=function(){console.log("undone");var e=sessionStorage.getItem("selected");trashFiles($("<div/>").html(e).contents())};
function fileCount(e){var t=getFilesNotOwned(e),a=t[0],o=t[1];return document.getElementById("file-counts").innerHTML='<p id="file-count" class="mdl-typography--headline">  Files You Own: '+a.length+'</p>  <p id="file-count" class="mdl-typography--headline">  Files Shared With You: '+o.length+'</p>  <p id="file-count" class="mdl-typography--headline">  Total: '+e.length+"</p>",[a,o]}function getFilesNotOwned(e){var t=[],a=e.filter(function(e){return e.ownedByMe===!0||void t.push(e)});return[a,t]}function displayGraph(e){function t(){var e=google.visualization.arrayToDataTable(s),t={title:"Hello",chartArea:{left:100}},l=new google.visualization.PieChart(document.getElementById("piechart"));l.draw(e,t),$("#graph-loader").remove(),$("#piechart-button").on("click",function(){s=s==a?o:a;var e=google.visualization.arrayToDataTable(s);l.draw(e,t)})}var a=[["Type","Number"]],o=[["Type","Quota Used"]],l=1,n=seperateBy(e,"type");for(var i in n){a.push([i,n[i].files.length]),o.push([i,0]);for(var r in n[i].files)0!=n[i].files[r].quotaBytesUsed&&(o[l][1]+=parseInt(n[i].files[r].quotaBytesUsed));l+=1}var s=a;google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(t)}